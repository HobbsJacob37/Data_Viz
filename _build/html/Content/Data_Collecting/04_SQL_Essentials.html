
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SQL Essentials &#8212; Data Pre-Processing and Visualization OER</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SQL Sub-Queries" href="05_SQL_SubQuery.html" />
    <link rel="prev" title="Learning Some SQL with BigQuery" href="03_SQL.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Data Pre-Processing and Visualization OER</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Introduction.html">
   Data Pre-Processing and Visualization
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Python.html">
   Jupyter Notebooks and Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Pandas.html">
   Pandas for Data Analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Gathering Data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="03_SQL.html">
   Learning Some SQL with BigQuery
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="08_html.html">
   Reading Data From the Web
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="09_html_tables.html">
     HTML Tables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="10_html_selenium.html">
     Webpage Loading and Scrapping
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_Twitter.html">
   Twitter a Social Media Scrape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_GatheringConclusion.html">
   Gathering Data Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Cleaning Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Cleaning/13_Data_Types.html">
   Data Types
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/14_Strings.html">
     Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/15_String_Cleaning.html">
     Strings And Cleaning a DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/16_Dates.html">
     Dates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/17_Ints_and_Floats.html">
     Integers and Floats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/18_One_Hot_Encoding.html">
     Factors and One Hot Encoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/19_Missing_and_Incomplete.html">
     Missing and Incomplete
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Cleaning/20_Cleaning_Conclusion.html">
     Exam 2 Review
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Great Visualizations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/21_Graphical_Excellence.html">
   Graphical Excellence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/22_Graphical_Integrity.html">
   Graphical Integrity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/23_Graphical_Sophistication.html">
   Graphical Sophistication
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Creating Visulaizations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/24_Amounts.html">
   Visualize Amounts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/25_Histograms.html">
   Histograms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/26_Many_Distributions.html">
   Many Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/27_Proportions.html">
   Proportions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/28_Associations.html">
   Visualizing Association
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/29_Uncertainty.html">
   Uncertainty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_Visualization/30_Visualize_Conclusion.html">
   Visualization Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Examples
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Project_Examples/RecentVisualizations.html">
   Inverted Yield Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Project_Examples/RecreatingMasters.html">
   NHL Data Visualization
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Selected Solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/mySolutions.html">
   My Solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Exam1Solutions.html">
   Exam 1 Solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Exam2Solutions.html">
   Exam 2 Solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Exam3Solutions.html">
   Exam 3 Solutions Data Visualization and Preprocessing
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Content/Data_Collecting/04_SQL_Essentials.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/nurfnick/Data_Viz"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/nurfnick/Data_Viz/issues/new?title=Issue%20on%20page%20%2FContent/Data_Collecting/04_SQL_Essentials.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/nurfnick/Data_Viz/master?urlpath=tree/Content/Data_Collecting/04_SQL_Essentials.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/nurfnick/Data_Viz/blob/master/Content/Data_Collecting/04_SQL_Essentials.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignment">
   Assignment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#me-playing-around">
   Me Playing Around
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/nurfnick/Data_Viz/blob/main/Content/Data_Collecting/04_SQL_Essentials.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="sql-essentials">
<h1>SQL Essentials<a class="headerlink" href="#sql-essentials" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">auth</span>
<span class="n">auth</span><span class="o">.</span><span class="n">authenticate_user</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Authenticated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Authenticated
</pre></div>
</div>
</div>
</div>
<p>Let’s start with the basics.  I’ll continue to work with the liquor store data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT *
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e4df2a5f-c715-4e6b-84f3-fb55c56dcfe1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>invoice_and_item_number</th>
      <th>date</th>
      <th>store_number</th>
      <th>store_name</th>
      <th>address</th>
      <th>city</th>
      <th>zip_code</th>
      <th>store_location</th>
      <th>county_number</th>
      <th>county</th>
      <th>category</th>
      <th>category_name</th>
      <th>vendor_number</th>
      <th>vendor_name</th>
      <th>item_number</th>
      <th>item_description</th>
      <th>pack</th>
      <th>bottle_volume_ml</th>
      <th>state_bottle_cost</th>
      <th>state_bottle_retail</th>
      <th>bottles_sold</th>
      <th>sale_dollars</th>
      <th>volume_sold_liters</th>
      <th>volume_sold_gallons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>INV-25210600054</td>
      <td>2020-02-13</td>
      <td>3385</td>
      <td>Sam's Club 8162 / Cedar Rapids</td>
      <td>2605 Blairs Ferry Rd NE</td>
      <td>Cedar Rapids</td>
      <td>52402.0</td>
      <td>POINT (-91.67969 42.031819)</td>
      <td>57</td>
      <td>LINN</td>
      <td>1081500.0</td>
      <td>Triple Sec</td>
      <td>55</td>
      <td>SAZERAC NORTH AMERICA</td>
      <td>86390</td>
      <td>Montezuma Triple Sec</td>
      <td>12</td>
      <td>1000</td>
      <td>2.13</td>
      <td>3.20</td>
      <td>48</td>
      <td>153.60</td>
      <td>48.0</td>
      <td>12.68</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S23115100025</td>
      <td>2014-12-22</td>
      <td>5004</td>
      <td>Ida Grove Food Pride</td>
      <td>200 SUSAN LAWRENCE DR</td>
      <td>IDA GROVE</td>
      <td>51445</td>
      <td>None</td>
      <td>47</td>
      <td>Ida</td>
      <td>1042100.0</td>
      <td>IMPORTED DRY GINS</td>
      <td>260</td>
      <td>Diageo Americas</td>
      <td>28867</td>
      <td>Tanqueray Gin</td>
      <td>12</td>
      <td>1000</td>
      <td>15.25</td>
      <td>22.88</td>
      <td>4</td>
      <td>91.52</td>
      <td>4.0</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S18402900152</td>
      <td>2014-04-14</td>
      <td>4312</td>
      <td>I-80 Liquor / Council Bluffs</td>
      <td>2411 S 24TH ST #1</td>
      <td>COUNCIL BLUFFS</td>
      <td>51501</td>
      <td>POINT (-95.8792 41.238092)</td>
      <td>78</td>
      <td>Pottawattamie</td>
      <td>1042100.0</td>
      <td>IMPORTED DRY GINS</td>
      <td>35</td>
      <td>Bacardi U.S.A., Inc.</td>
      <td>28233</td>
      <td>Bombay Sapphire Gin</td>
      <td>12</td>
      <td>1000</td>
      <td>17.61</td>
      <td>26.41</td>
      <td>11</td>
      <td>290.51</td>
      <td>11.0</td>
      <td>2.91</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S14219300007</td>
      <td>2013-08-29</td>
      <td>4844</td>
      <td>Iowa City Fast Break</td>
      <td>2580, NAPLES AVE</td>
      <td>IOWA CITY</td>
      <td>52240</td>
      <td>POINT (-91.571064 41.632792)</td>
      <td>52</td>
      <td>Johnson</td>
      <td>1011500.0</td>
      <td>STRAIGHT RYE WHISKIES</td>
      <td>255</td>
      <td>Wilson Daniels Ltd.</td>
      <td>27102</td>
      <td>Templeton Rye</td>
      <td>6</td>
      <td>750</td>
      <td>18.08</td>
      <td>27.13</td>
      <td>18</td>
      <td>488.34</td>
      <td>13.5</td>
      <td>3.57</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S24682700083</td>
      <td>2015-03-24</td>
      <td>2604</td>
      <td>Hy-Vee Wine and Spirits / Lemars</td>
      <td>1201 12TH AVE SW</td>
      <td>LEMARS</td>
      <td>51031</td>
      <td>POINT (-96.18335000000002 42.778257)</td>
      <td>75</td>
      <td>Plymouth</td>
      <td>1081365.0</td>
      <td>TROPICAL FRUIT SCHNAPPS</td>
      <td>421</td>
      <td>Sazerac Co., Inc.</td>
      <td>83907</td>
      <td>Maui Blue Hawaiian Schnapps</td>
      <td>12</td>
      <td>1000</td>
      <td>4.54</td>
      <td>6.81</td>
      <td>4</td>
      <td>27.24</td>
      <td>4.0</td>
      <td>1.06</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e4df2a5f-c715-4e6b-84f3-fb55c56dcfe1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e4df2a5f-c715-4e6b-84f3-fb55c56dcfe1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e4df2a5f-c715-4e6b-84f3-fb55c56dcfe1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Why did I run that command?  Well it gives me an idea of what is in the table to reference and think about what questions I might ask!  Let’s see how many gallons of liqour have been sold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT SUM(volume_sold_gallons) as Total_Gallons_of_Liquor
FROM `bigquery-public-data.iowa_liquor_sales.sales`
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fa3e6766-01f8-4eb1-9a6b-81b3534738b1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Gallons_of_Liquor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.560763e+07</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fa3e6766-01f8-4eb1-9a6b-81b3534738b1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fa3e6766-01f8-4eb1-9a6b-81b3534738b1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fa3e6766-01f8-4eb1-9a6b-81b3534738b1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Let’s do a small conversion just to see what that means.  An olympic pool holds 660 000 gallons so</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">5.560763</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="mi">660000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84.25398484848485
</pre></div>
</div>
</div>
</div>
<p>About 84 swimming pools of liquor in Iowa!  Fun times…</p>
<p>Let’s make it more complicated.  Let’s see what the dollars per gallon is on the full dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT SUM(sale_dollars)/SUM(volume_sold_gallons) as Total_Dollars_Per_Gallon
FROM `bigquery-public-data.iowa_liquor_sales.sales`
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4bdad4a8-e4e6-4857-bd31-92979ac86f2a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Dollars_Per_Gallon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>57.373869</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4bdad4a8-e4e6-4857-bd31-92979ac86f2a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4bdad4a8-e4e6-4857-bd31-92979ac86f2a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4bdad4a8-e4e6-4857-bd31-92979ac86f2a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Okay not terribly interesting.  Let’s take that quesiton and add too it.  Let’s create a column that is dollars per gallon of liquor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT sale_dollars/volume_sold_gallons as Dollars_Per_Gallon
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0
LIMIT 5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a6223d25-28ec-4476-8b99-759be51e05b9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars_Per_Gallon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13.741325</td>
    </tr>
    <tr>
      <th>1</th>
      <td>94.537815</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28.391167</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48.692516</td>
    </tr>
    <tr>
      <th>4</th>
      <td>136.840336</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a6223d25-28ec-4476-8b99-759be51e05b9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a6223d25-28ec-4476-8b99-759be51e05b9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a6223d25-28ec-4476-8b99-759be51e05b9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>I have added a few new things here.  The <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause allows me to restrict what I consider.  You can combine several of the statements logically</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT sale_dollars/volume_sold_gallons as Dollars_Per_Gallon, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0 and category_name = &#39;Coffee Liqueurs&#39;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-73fdeb01-935d-471e-b6e2-25d6b1ce1f5b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dollars_Per_Gallon</th>
      <th>item_description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>136.363636</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>136.134454</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>2</th>
      <td>136.134454</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>135.000000</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>118.421053</td>
      <td>Mozart Chocolate Coffee Cream Liqueur</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78766</th>
      <td>91.474576</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>78767</th>
      <td>91.474576</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>78768</th>
      <td>91.474576</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>78769</th>
      <td>91.474576</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>78770</th>
      <td>91.474576</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
  </tbody>
</table>
<p>78771 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-73fdeb01-935d-471e-b6e2-25d6b1ce1f5b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-73fdeb01-935d-471e-b6e2-25d6b1ce1f5b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-73fdeb01-935d-471e-b6e2-25d6b1ce1f5b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>I added the <code class="docutils literal notranslate"><span class="pre">item_description</span></code> so that I could see which ones were different.  It is not utilized the the analysis yet.  Let’s include it by getting the average price of coffee liqueurs based on the description.  To do this I’ll add the <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> command</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT AVG(sale_dollars/volume_sold_gallons) as Average_Dollars_Per_Gallon, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0 and category_name = &#39;Coffee Liqueurs&#39;
GROUP BY item_description
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-88cc995d-52e2-4abe-98dc-0502d898a8a6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average_Dollars_Per_Gallon</th>
      <th>item_description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93.411691</td>
      <td>Kahlua Coffee</td>
    </tr>
    <tr>
      <th>1</th>
      <td>776.615963</td>
      <td>Kahlua Coffee Mini</td>
    </tr>
    <tr>
      <th>2</th>
      <td>92.405096</td>
      <td>Kahlua Coffee Liqueur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48.811417</td>
      <td>Kamora Coffee Liqueur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>109.767153</td>
      <td>Patron Xo Cafe</td>
    </tr>
    <tr>
      <th>5</th>
      <td>76.032478</td>
      <td>Kahlua Coffee Liqueur Mini</td>
    </tr>
    <tr>
      <th>6</th>
      <td>187.292855</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>7</th>
      <td>41.034034</td>
      <td>Kapali Coffee Liqueur</td>
    </tr>
    <tr>
      <th>8</th>
      <td>94.736642</td>
      <td>Kahlua Salted Caramel</td>
    </tr>
    <tr>
      <th>9</th>
      <td>38.571044</td>
      <td>Chila Coffee Liqueur</td>
    </tr>
    <tr>
      <th>10</th>
      <td>96.502963</td>
      <td>Kahlua Vanilla</td>
    </tr>
    <tr>
      <th>11</th>
      <td>38.358325</td>
      <td>Caffe Lolita Coffee Liqueur</td>
    </tr>
    <tr>
      <th>12</th>
      <td>90.549048</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>13</th>
      <td>44.152230</td>
      <td>Copa De Oro Mexican Coffee</td>
    </tr>
    <tr>
      <th>14</th>
      <td>107.826091</td>
      <td>Patron XO Cafe</td>
    </tr>
    <tr>
      <th>15</th>
      <td>115.010680</td>
      <td>Mozart Chocolate Coffee Cream Liqueur</td>
    </tr>
    <tr>
      <th>16</th>
      <td>205.745228</td>
      <td>Kahlua French Vanilla Liqueur</td>
    </tr>
    <tr>
      <th>17</th>
      <td>72.869733</td>
      <td>Carolans Cold Brew</td>
    </tr>
    <tr>
      <th>18</th>
      <td>137.784413</td>
      <td>Original Secret Family Recipe - A Coffee Liqueur</td>
    </tr>
    <tr>
      <th>19</th>
      <td>68.270587</td>
      <td>Grind Espresso Shot</td>
    </tr>
    <tr>
      <th>20</th>
      <td>90.705882</td>
      <td>Kahlua Especial</td>
    </tr>
    <tr>
      <th>21</th>
      <td>117.936185</td>
      <td>Tia Maria Coffee Liqueur</td>
    </tr>
    <tr>
      <th>22</th>
      <td>118.170457</td>
      <td>J. Rieger &amp; Co. Caffe Amaro</td>
    </tr>
    <tr>
      <th>23</th>
      <td>248.540562</td>
      <td>CCD Coffee Liqueur</td>
    </tr>
    <tr>
      <th>24</th>
      <td>90.705882</td>
      <td>Kahlua Peppermint Mocha</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1136.210526</td>
      <td>Kahlua Chili Chocolate</td>
    </tr>
    <tr>
      <th>26</th>
      <td>16.996845</td>
      <td>Conciere Coffee Liqueur</td>
    </tr>
    <tr>
      <th>27</th>
      <td>65.656795</td>
      <td>Dr McGillicuddys Coffee</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-88cc995d-52e2-4abe-98dc-0502d898a8a6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-88cc995d-52e2-4abe-98dc-0502d898a8a6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-88cc995d-52e2-4abe-98dc-0502d898a8a6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Okay but we pointed out earlier that there is no order…  Let’s force an order on it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT AVG(sale_dollars/volume_sold_gallons) as Average_Dollars_Per_Gallon, item_description
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0 and category_name = &#39;Coffee Liqueurs&#39;
GROUP BY item_description
ORDER BY Average_Dollars_Per_Gallon DESC
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fec4ea5d-b7d7-47a8-ab81-2536f77e8a02">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average_Dollars_Per_Gallon</th>
      <th>item_description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1136.210526</td>
      <td>Kahlua Chili Chocolate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>776.615963</td>
      <td>Kahlua Coffee Mini</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248.540562</td>
      <td>CCD Coffee Liqueur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>205.745228</td>
      <td>Kahlua French Vanilla Liqueur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187.292855</td>
      <td>Iowa Coffee Company Liqueur</td>
    </tr>
    <tr>
      <th>5</th>
      <td>137.784413</td>
      <td>Original Secret Family Recipe - A Coffee Liqueur</td>
    </tr>
    <tr>
      <th>6</th>
      <td>118.170457</td>
      <td>J. Rieger &amp; Co. Caffe Amaro</td>
    </tr>
    <tr>
      <th>7</th>
      <td>117.936185</td>
      <td>Tia Maria Coffee Liqueur</td>
    </tr>
    <tr>
      <th>8</th>
      <td>115.010680</td>
      <td>Mozart Chocolate Coffee Cream Liqueur</td>
    </tr>
    <tr>
      <th>9</th>
      <td>109.767153</td>
      <td>Patron Xo Cafe</td>
    </tr>
    <tr>
      <th>10</th>
      <td>107.826091</td>
      <td>Patron XO Cafe</td>
    </tr>
    <tr>
      <th>11</th>
      <td>96.502963</td>
      <td>Kahlua Vanilla</td>
    </tr>
    <tr>
      <th>12</th>
      <td>94.736642</td>
      <td>Kahlua Salted Caramel</td>
    </tr>
    <tr>
      <th>13</th>
      <td>93.411691</td>
      <td>Kahlua Coffee</td>
    </tr>
    <tr>
      <th>14</th>
      <td>92.405096</td>
      <td>Kahlua Coffee Liqueur</td>
    </tr>
    <tr>
      <th>15</th>
      <td>90.705882</td>
      <td>Kahlua Especial</td>
    </tr>
    <tr>
      <th>16</th>
      <td>90.705882</td>
      <td>Kahlua Peppermint Mocha</td>
    </tr>
    <tr>
      <th>17</th>
      <td>90.549048</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
    </tr>
    <tr>
      <th>18</th>
      <td>76.032478</td>
      <td>Kahlua Coffee Liqueur Mini</td>
    </tr>
    <tr>
      <th>19</th>
      <td>72.869733</td>
      <td>Carolans Cold Brew</td>
    </tr>
    <tr>
      <th>20</th>
      <td>68.270587</td>
      <td>Grind Espresso Shot</td>
    </tr>
    <tr>
      <th>21</th>
      <td>65.656795</td>
      <td>Dr McGillicuddys Coffee</td>
    </tr>
    <tr>
      <th>22</th>
      <td>48.811417</td>
      <td>Kamora Coffee Liqueur</td>
    </tr>
    <tr>
      <th>23</th>
      <td>44.152230</td>
      <td>Copa De Oro Mexican Coffee</td>
    </tr>
    <tr>
      <th>24</th>
      <td>41.034034</td>
      <td>Kapali Coffee Liqueur</td>
    </tr>
    <tr>
      <th>25</th>
      <td>38.571044</td>
      <td>Chila Coffee Liqueur</td>
    </tr>
    <tr>
      <th>26</th>
      <td>38.358325</td>
      <td>Caffe Lolita Coffee Liqueur</td>
    </tr>
    <tr>
      <th>27</th>
      <td>16.996845</td>
      <td>Conciere Coffee Liqueur</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fec4ea5d-b7d7-47a8-ab81-2536f77e8a02')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fec4ea5d-b7d7-47a8-ab81-2536f77e8a02 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fec4ea5d-b7d7-47a8-ab81-2536f77e8a02');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Let’s keep going down the rabbit hole here.  What if we want to rank them?  There are lots of ways <code class="docutils literal notranslate"><span class="pre">ROW_NUMBER</span></code>, <code class="docutils literal notranslate"><span class="pre">RANK</span></code> and <code class="docutils literal notranslate"><span class="pre">DENSE_RANK</span></code>.  I find them difficult to use because they require lots of other inputs.</p>
<p>The general call is something like</p>
<p><code class="docutils literal notranslate"><span class="pre">ROW_NUMBER()</span> <span class="pre">OVER(PARTITION</span> <span class="pre">BY</span> <span class="pre">________</span> <span class="pre">ORDER</span> <span class="pre">BY</span> <span class="pre">_________)</span></code></p>
<p>Partition is like grouping.  I’ll add another liquor to use it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT 
  AVG(sale_dollars/volume_sold_gallons) as Average_Dollars_Per_Gallon, 
  item_description, 
  ROW_NUMBER() OVER(
    PARTITION BY category_name
    ORDER BY item_description) row_num
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0 and (category_name = &#39;Coffee Liqueurs&#39;)
GROUP BY item_description, category_name
ORDER BY Average_Dollars_Per_Gallon DESC
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-04fdd617-768a-465d-a115-54cd3544dc30">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average_Dollars_Per_Gallon</th>
      <th>item_description</th>
      <th>row_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1136.210526</td>
      <td>Kahlua Chili Chocolate</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>776.615963</td>
      <td>Kahlua Coffee Mini</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248.540562</td>
      <td>CCD Coffee Liqueur</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>205.745228</td>
      <td>Kahlua French Vanilla Liqueur</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187.292855</td>
      <td>Iowa Coffee Company Liqueur</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>137.784413</td>
      <td>Original Secret Family Recipe - A Coffee Liqueur</td>
      <td>25</td>
    </tr>
    <tr>
      <th>6</th>
      <td>118.170457</td>
      <td>J. Rieger &amp; Co. Caffe Amaro</td>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>117.936185</td>
      <td>Tia Maria Coffee Liqueur</td>
      <td>28</td>
    </tr>
    <tr>
      <th>8</th>
      <td>115.010680</td>
      <td>Mozart Chocolate Coffee Cream Liqueur</td>
      <td>24</td>
    </tr>
    <tr>
      <th>9</th>
      <td>109.767153</td>
      <td>Patron Xo Cafe</td>
      <td>27</td>
    </tr>
    <tr>
      <th>10</th>
      <td>107.826091</td>
      <td>Patron XO Cafe</td>
      <td>26</td>
    </tr>
    <tr>
      <th>11</th>
      <td>96.502963</td>
      <td>Kahlua Vanilla</td>
      <td>21</td>
    </tr>
    <tr>
      <th>12</th>
      <td>94.736642</td>
      <td>Kahlua Salted Caramel</td>
      <td>20</td>
    </tr>
    <tr>
      <th>13</th>
      <td>93.411691</td>
      <td>Kahlua Coffee</td>
      <td>12</td>
    </tr>
    <tr>
      <th>14</th>
      <td>92.405096</td>
      <td>Kahlua Coffee Liqueur</td>
      <td>13</td>
    </tr>
    <tr>
      <th>15</th>
      <td>90.705882</td>
      <td>Kahlua Especial</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>90.705882</td>
      <td>Kahlua Peppermint Mocha</td>
      <td>19</td>
    </tr>
    <tr>
      <th>17</th>
      <td>90.549048</td>
      <td>Kahlua French Vanilla Liqueur DISCO</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18</th>
      <td>76.032478</td>
      <td>Kahlua Coffee Liqueur Mini</td>
      <td>14</td>
    </tr>
    <tr>
      <th>19</th>
      <td>72.869733</td>
      <td>Carolans Cold Brew</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>68.270587</td>
      <td>Grind Espresso Shot</td>
      <td>8</td>
    </tr>
    <tr>
      <th>21</th>
      <td>65.656795</td>
      <td>Dr McGillicuddys Coffee</td>
      <td>7</td>
    </tr>
    <tr>
      <th>22</th>
      <td>48.811417</td>
      <td>Kamora Coffee Liqueur</td>
      <td>22</td>
    </tr>
    <tr>
      <th>23</th>
      <td>44.152230</td>
      <td>Copa De Oro Mexican Coffee</td>
      <td>6</td>
    </tr>
    <tr>
      <th>24</th>
      <td>41.034034</td>
      <td>Kapali Coffee Liqueur</td>
      <td>23</td>
    </tr>
    <tr>
      <th>25</th>
      <td>38.571044</td>
      <td>Chila Coffee Liqueur</td>
      <td>4</td>
    </tr>
    <tr>
      <th>26</th>
      <td>38.358325</td>
      <td>Caffe Lolita Coffee Liqueur</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>16.996845</td>
      <td>Conciere Coffee Liqueur</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-04fdd617-768a-465d-a115-54cd3544dc30')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-04fdd617-768a-465d-a115-54cd3544dc30 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-04fdd617-768a-465d-a115-54cd3544dc30');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>You should notice that the <code class="docutils literal notranslate"><span class="pre">ROW_NUMBER</span></code> didn’t do what we needed.  You will not be able to do the row nor rank on the column we created because it is not yet available to the SQL call.  This leads to sub-processees.  Let’s show one today and come back to it next class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
WITH t as(
SELECT 
  AVG(sale_dollars/volume_sold_gallons) as Average_Dollars_Per_Gallon, 
  item_description, category_name
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE volume_sold_gallons != 0 and (category_name = &#39;Coffee Liqueurs&#39; or category_name = &#39;Imported Vodkas&#39;)
GROUP BY item_description, category_name
ORDER BY Average_Dollars_Per_Gallon DESC
)

SELECT *, 
    RANK() OVER(
    PARTITION BY category_name
    ORDER BY Average_Dollars_Per_Gallon) rk_num
FROM t
ORDER BY rk_num
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cfe36062-5486-4caa-8792-7c1deae9f2a5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average_Dollars_Per_Gallon</th>
      <th>item_description</th>
      <th>category_name</th>
      <th>rk_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.996845</td>
      <td>Conciere Coffee Liqueur</td>
      <td>Coffee Liqueurs</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>23.335834</td>
      <td>SOOH Relska 80 Proof Vodka</td>
      <td>Imported Vodkas</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38.358325</td>
      <td>Caffe Lolita Coffee Liqueur</td>
      <td>Coffee Liqueurs</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27.608509</td>
      <td>Polar Ice</td>
      <td>Imported Vodkas</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>38.571044</td>
      <td>Chila Coffee Liqueur</td>
      <td>Coffee Liqueurs</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>164</th>
      <td>2921.600000</td>
      <td>Grey Goose Essences Strawberry &amp; Lemongrass Mini</td>
      <td>Imported Vodkas</td>
      <td>137</td>
    </tr>
    <tr>
      <th>165</th>
      <td>2935.463736</td>
      <td>Grey Goose Essences Watermelon &amp; Basil Mini</td>
      <td>Imported Vodkas</td>
      <td>138</td>
    </tr>
    <tr>
      <th>166</th>
      <td>9000.000000</td>
      <td>Outerspace Vodka Mini</td>
      <td>Imported Vodkas</td>
      <td>139</td>
    </tr>
    <tr>
      <th>167</th>
      <td>16996.723367</td>
      <td>E.T.51 Premium Vodka Mini</td>
      <td>Imported Vodkas</td>
      <td>140</td>
    </tr>
    <tr>
      <th>168</th>
      <td>17136.000000</td>
      <td>E.T. 51 Premium Vodka Mini</td>
      <td>Imported Vodkas</td>
      <td>141</td>
    </tr>
  </tbody>
</table>
<p>169 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cfe36062-5486-4caa-8792-7c1deae9f2a5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cfe36062-5486-4caa-8792-7c1deae9f2a5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cfe36062-5486-4caa-8792-7c1deae9f2a5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>We will come back to this but a nice taste of some of the really powerful aspects of SQL!</p>
<div class="section" id="assignment">
<h2>Assignment<a class="headerlink" href="#assignment" title="Permalink to this headline">¶</a></h2>
<p>Assignement for today</p>
<ol class="simple">
<li><p>Start a notebook getting BigQuery to work. Feel free to use the authentication atop.</p></li>
<li><p>Navigate to the dataset ‘austin_bikeshare.bikeshare_trips’</p></li>
<li><p>Compute the average time for a trip based on starting point</p></li>
<li><p>Compute how many trips start at each starting point.</p></li>
</ol>
</div>
<div class="section" id="me-playing-around">
<h2>Me Playing Around<a class="headerlink" href="#me-playing-around" title="Permalink to this headline">¶</a></h2>
<p>I wanted to find why ‘vodka’ wasn’t in the table.  Well it was but with other qualifiers.  I needed to use a string command <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> I also looked at <code class="docutils literal notranslate"><span class="pre">CONTAINS</span></code> but didn’t get it to work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>%%bigquery --project pic-math
SELECT category_name
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE category_name LIKE &#39;%Vodka%&#39;
GROUP BY category_name
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-aeb76027-237e-458b-bd75-5f7fdb15a16a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Imported Vodka</td>
    </tr>
    <tr>
      <th>1</th>
      <td>American Vodka</td>
    </tr>
    <tr>
      <th>2</th>
      <td>American Vodkas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Imported Vodkas</td>
    </tr>
    <tr>
      <th>4</th>
      <td>American Flavored Vodka</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Imported Flavored Vodka</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aeb76027-237e-458b-bd75-5f7fdb15a16a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aeb76027-237e-458b-bd75-5f7fdb15a16a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aeb76027-237e-458b-bd75-5f7fdb15a16a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Content\Data_Collecting"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_SQL.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Learning Some SQL with BigQuery</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="05_SQL_SubQuery.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SQL Sub-Queries</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>